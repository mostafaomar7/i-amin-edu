<!-- Analytics Section -->
<div class="row">
  <!-- ===== Instructor Dashboard (currentUser === 3) ===== -->
  <div class="col-lg-3 col-sm-6 col-12" *ngIf="currentUser === 3">
    <div class="card">
      <div class="card-header d-flex flex-column align-items-start pb-0">
        <div class="avatar p-50 m-0" style="background-color: #7367F0;">
          <div class="avatar-content">
            <i class="fas fa-comments"></i>
          </div>
        </div>
        <h2 class="font-weight-bolder mt-1">{{ data?.totalConsultations ?? 0 }}</h2>
        <h4 class="mb-0">Consultations</h4>
        <p class="mb-0 text-muted">This Year</p>
      </div>

      <div id="totalConsultations">
        <apx-chart
          [series]="consultationsChart.series"
          [chart]="consultationsChart.chart"
          [stroke]="consultationsChart.stroke"
          [fill]="consultationsChart.fill"
          [tooltip]="consultationsChart.tooltip"
          [colors]="consultationsChart.colors"
          [dataLabels]="consultationsChart.dataLabels">
        </apx-chart>
      </div>
    </div>
  </div>

  <div class="col-lg-3 col-sm-6 col-12" *ngIf="currentUser === 3">
    <div class="card">
      <div class="card-header d-flex flex-column align-items-start pb-0">
        <div class="avatar p-50 m-0" style="background-color: #7367F0;">
          <div class="avatar-content">
            <i class="fas fa-book"></i>
          </div>
        </div>
        <h2 class="font-weight-bolder mt-1">{{ data?.totalCourses ?? 0 }}</h2>
        <h4 class="mb-0">Courses</h4>
        <p class="mb-0 text-muted">This Year</p>
      </div>

      <div id="courses">
        <apx-chart
          [series]="courses.series"
          [chart]="courses.chart"
          [stroke]="courses.stroke"
          [fill]="courses.fill"
          [tooltip]="courses.tooltip"
          [colors]="courses.colors"
          [dataLabels]="courses.dataLabels">
        </apx-chart>
      </div>
    </div>
  </div>

  <!-- ===== Broker Dashboard (currentUser === 5) ===== -->
  <div class="col-lg-3 col-sm-6 col-12" *ngIf="currentUser === 5">
    <div class="card">
      <div class="card-header d-flex flex-column align-items-start pb-0">
        <div class="avatar p-50 m-0" style="background-color: #7367F0;">
          <div class="avatar-content">
            <i class="fas fa-chalkboard-teacher"></i>
          </div>
        </div>
        <h2 class="font-weight-bolder mt-1">{{ instructorsList.length }}</h2>
        <h4 class="mb-0">Instructors</h4>
        <p class="mb-0 text-muted">This Year</p>
      </div>

      <div id="brokerInstructorsChart">
        <apx-chart
          [series]="brokerInstructorsChart.series"
          [chart]="brokerInstructorsChart.chart"
          [stroke]="brokerInstructorsChart.stroke"
          [fill]="brokerInstructorsChart.fill"
          [tooltip]="brokerInstructorsChart.tooltip"
          [colors]="brokerInstructorsChart.colors"
          [dataLabels]="brokerInstructorsChart.dataLabels">
        </apx-chart>
      </div>
    </div>
  </div>

  <div class="col-lg-3 col-sm-6 col-12" *ngIf="currentUser === 5">
    <div class="card">
      <div class="card-header d-flex flex-column align-items-start pb-0">
        <div class="avatar p-50 m-0" style="background-color: #FF5888;">
          <div class="avatar-content">
            <i class="fas fa-university"></i>
          </div>
        </div>
        <h2 class="font-weight-bolder mt-1">{{ organizationsList.length }}</h2>
        <h4 class="mb-0">Organizations</h4>
        <p class="mb-0 text-muted">This Year</p>
      </div>

      <div id="brokerOrganizationsChart">
        <apx-chart
          [series]="brokerOrganizationsChart.series"
          [chart]="brokerOrganizationsChart.chart"
          [stroke]="brokerOrganizationsChart.stroke"
          [fill]="brokerOrganizationsChart.fill"
          [tooltip]="brokerOrganizationsChart.tooltip"
          [colors]="brokerOrganizationsChart.colors"
          [dataLabels]="brokerOrganizationsChart.dataLabels">
        </apx-chart>
      </div>
    </div>
  </div>

  <!-- ===== Shared Cards (Appear for all) ===== -->
  <div class="col-lg-3 col-sm-6 col-12" *ngIf="currentUser !== 1">
    <div class="card">
      <div class="card-header d-flex flex-column align-items-start pb-0">
        <div class="avatar p-50 m-0" style="background-color: #7367F0;">
          <div class="avatar-content">
            <i class="fas fa-person"></i>
          </div>
        </div>
        <h2 class="font-weight-bolder mt-1">{{ data?.totalEnrollments ?? 'N/A' }}</h2>
        <h4 class="mb-0">Total Enrollments</h4>
        <p class="mb-0 text-muted">This Year</p>
      </div>

      <div id="totalEnrollments" >
        <apx-chart
          [series]="totalEnrollments.series"
          [chart]="totalEnrollments.chart"
          [stroke]="totalEnrollments.stroke"
          [fill]="totalEnrollments.fill"
          [tooltip]="totalEnrollments.tooltip"
          [colors]="totalEnrollments.colors"
          [dataLabels]="totalEnrollments.dataLabels">
        </apx-chart>
      </div>
    </div>
  </div>

  <div class="col-lg-3 col-sm-6 col-12" *ngIf="currentUser !== 1">
    <div class="card">
      <div class="card-header d-flex flex-column align-items-start pb-0">
        <div class="avatar p-50 m-0" style="background-color: #28C76F;">
          <div class="avatar-content">
            <i class="fas fa-money-bill"></i>
          </div>
        </div>
        <h2 class="font-weight-bolder mt-1">{{ data?.totalWalletBalance | currency:'EGP':'symbol':'1.2-2' }}</h2>
        <h4 class="mb-0">Wallet Balance</h4>
        <p class="mb-0 text-muted">This Year</p>
      </div>

      <div id="walletBalance">
        <apx-chart
          [series]="walletBalance.series"
          [chart]="walletBalance.chart"
          [stroke]="walletBalance.stroke"
          [fill]="walletBalance.fill"
          [tooltip]="walletBalance.tooltip"
          [colors]="walletBalance.colors"
          [dataLabels]="walletBalance.dataLabels">
        </apx-chart>
      </div>
    </div>
  </div>
</div>



<!-- <div class="dashboard-statistics">

  <h3>Dashboard Statistics</h3>

  <div class="stats-grid">

    <div class="stat-card">
      <h4>Total Courses</h4>
      <p>{{ data?.totalCourses ?? 'N/A' }}</p>
    </div>

    <div class="stat-card">
      <h4>Total Consultations</h4>
      <p>{{ data?.totalConsultations ?? 'N/A' }}</p>
    </div>

    <div class="stat-card">
      <h4>Total Consultations Amount</h4>
      <p>{{ data?.totalConsultationsAmount | currency:'USD':'symbol':'1.2-2' }}</p>
    </div>

    <div class="stat-card">
      <h4>Total Organizations</h4>
      <p>{{ data?.totalOrganizations ?? 'N/A' }}</p>
    </div>

    <div class="stat-card">
      <h4>Total Instructors</h4>
      <p>{{ data?.totalInstructors ?? 'N/A' }}</p>
    </div>

    <div class="stat-card">
      <h4>Total Enrollments</h4>
      <p>{{ data?.totalEnrollments ?? 'N/A' }}</p>
    </div>

    <div class="stat-card">
      <h4>Total Enrollments Amount</h4>
      <p>{{ data?.totalEnrollmentsAmount | currency:'USD':'symbol':'1.2-2' }}</p>
    </div>

    <div class="stat-card">
      <h4>Total Wallet Balance</h4>
      <p>{{ data?.totalWalletBalance | currency:'USD':'symbol':'1.2-2' }}</p>
    </div>

  </div>

</div> -->

<div class="content-wrapper container-xxl p-0"  >
    <div class="content-body">
        <!-- Card Advance -->
        <div class="row match-height" >

            <!-- Enrolments -->
             <div *ngIf="currentUser !== 3 && currentUser !== 5" class="col-lg-3 col-sm-6 col-12">
                <div class="card">
                    <div class="card-header d-flex flex-column align-items-start pb-0">
                        <div class="avatar p-50 m-0" style="background-color: #FF9F43;">
                            <div class="avatar-content">
                                <i class="fas fa-user-graduate"></i>
                            </div>
                        </div>
                        <h2 class="font-weight-bolder mt-1"> {{totalEnrollmentOverYear}} </h2>
                        <h4 class="mb-0">{{ 'ENROLMENTS' | translate }}</h4>
                        <p class="mb-0" style="color: gray;">{{ 'THIS_YEAR' | translate }}</p>
                    </div>

                    <!-- Apexchart component-->
                    <div id="enrollment" #gainedChartRef>
                        <apx-chart [series]="enrollment.series" [chart]="enrollment.chart" [stroke]="enrollment.stroke"
                            [fill]="enrollment.fill" [tooltip]="enrollment.tooltip" [colors]="enrollment.colors"
                            [dataLabels]="enrollment.dataLabels"></apx-chart>
                    </div>
                </div>
            </div>

            <!-- Organizations -->
            <div *ngIf="currentUser !== 3 && currentUser !== 5" class="col-lg-3 col-sm-6 col-12">

                <div class="card">
                    <div class="card-header d-flex flex-column align-items-start pb-0">
                        <div class="avatar p-50 m-0" style="background-color: #FF5888;">
                            <div class="avatar-content">
                                <i class="fas fa-university"></i>
                            </div>
                        </div>
                        <h2 class="font-weight-bolder mt-1"> {{totalOrganizationsOverYear}} </h2>
                        <h4 class="mb-0">{{ 'ORGANIZATIONS' | translate }}</h4>
                        <p class="mb-0" style="color: gray;">{{ 'THIS_YEAR' | translate }}</p>
                    </div>

                    <!-- Apexchart component-->
                    <div id="organizations" #gainedChartRef>
                        <apx-chart [series]="organizations.series" [chart]="organizations.chart"
                            [stroke]="organizations.stroke" [fill]="organizations.fill"
                            [tooltip]="organizations.tooltip" [colors]="organizations.colors"
                            [dataLabels]="organizations.dataLabels"></apx-chart>
                    </div>
                </div>
            </div>

            <!-- Total Instructors -->
            <div *ngIf="currentUser !== 3 && currentUser !== 5" class="col-lg-3 col-sm-6 col-12">

                <div class="card">
                    <div class="card-header d-flex flex-column align-items-start pb-0">
                        <div class="avatar p-50 m-0" style="background-color: #b9c3cd;">
                            <div class="avatar-content">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </div>
                        </div>
                        <h2 class="font-weight-bolder mt-1"> {{totalInstructorOverYear}} </h2>
                        <h4 class="mb-0">{{ 'TOTAL_INSTRUCTORS' | translate }}</h4>
                        <p class="mb-0" style="color: gray;">{{ 'THIS_YEAR' | translate }}</p>
                    </div>

                    <!-- Apexchart component-->
                    <div id="totalInstructors" #gainedChartRef1>
                        <apx-chart [series]="totalInstructors.series" [chart]="totalInstructors.chart"
                            [stroke]="totalInstructors.stroke" [fill]="totalInstructors.fill"
                            [tooltip]="totalInstructors.tooltip" [colors]="totalInstructors.colors"
                            [dataLabels]="totalInstructors.dataLabels"></apx-chart>
                    </div>
                </div>
            </div>

            <!-- Total Courses -->
             <div *ngIf="currentUser !== 3 && currentUser !== 5" class="col-lg-3 col-sm-6 col-12">
                <div class="card">
                    <div class="card-header d-flex flex-column align-items-start pb-0">
                        <div class="avatar p-50 m-0" style="background-color: #00cfe8;">
                            <div class="avatar-content">
                                <i class="fas fa-book-open"></i>
                            </div>
                        </div>
                        <h2 class="font-weight-bolder mt-1"> {{totalCoursesOverYear}} </h2>
                        <h4 class="mb-0">{{ 'TOTAL_COURSES' | translate }}</h4>
                        <p class="mb-0" style="color: gray;">{{ 'THIS_YEAR' | translate }}</p>
                    </div>

                    <!-- Apexchart component-->
                    <div id="totalCourses" #gainedChartRef>
                        <apx-chart [series]="totalCourses.series" [chart]="totalCourses.chart"
                            [stroke]="totalCourses.stroke" [fill]="totalCourses.fill" [tooltip]="totalCourses.tooltip"
                            [colors]="totalCourses.colors" [dataLabels]="totalCourses.dataLabels"></apx-chart>
                    </div>
                </div>
            </div>


            <!-- Recently Added Courses -->
            <div *ngIf="currentUser !== 5" class="col-lg-12 col-sm-6 col-12">
                <h4>{{ 'RECENTLY_ADDED_COURSES' | translate }}</h4>
                <app-course-list  [selectedCenterId]="0" [isBestSelling]="true" [hasActions]="false"
                    [hasHeader]="false"></app-course-list>
            </div>

            <!-- Recently Added Instructors -->
            <div class="col-lg-12 col-sm-6 col-12" *ngIf="currentUser !== 3 && currentUser !== 5">
                <h4>{{ 'RECENTLY_ADDED_INSTRUCTORS' | translate }}</h4>
                <app-instructors-list [selectedCenterId]="0" [isBestSelling]="true" [hasActions]="false"
                    [hasHeader]="false"></app-instructors-list>
            </div>
            <div class="content-wrapper container-xxl p-0 " *ngIf="currentUser === 3">
  <div class="content-body" style="margin-left: 12px;">
    <section>
        <h4 class="card-header">{{ 'RECENTLY_ADDED_SESSION' | translate }}</h4>
      <!-- Loading Spinner -->
      <div *ngIf="isLoading" class="spinner-grow" role="status">
        <span class="sr-only">{{ 'LOADING' | translate }}</span>
      </div>

      <!-- Table -->
      <div *ngIf="!isLoading" class="card p-2">

        <!-- Sessions Table -->
        <ngx-datatable [rows]="rows" [rowHeight]="70" class="bootstrap core-bootstrap" 
          [limit]="selectedOption" [columnMode]="ColumnMode.force"
          [headerHeight]="50" [footerHeight]="50" [scrollbarH]="true">

          <ngx-datatable-column name="#" [width]="40">
            <ng-template let-rowIndex="rowIndex" ngx-datatable-cell-template>
              {{ rowIndex + 1 }}
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="{{ 'STUDENT_BOOK' | translate }}">
            <ng-template let-row="row" ngx-datatable-cell-template>
              {{ row.studentCount }}
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="{{ 'TITLE' | translate }}">
            <ng-template let-row="row" ngx-datatable-cell-template>
              {{ row.title }}
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="{{ 'DATE_TIME' | translate }}">
            <ng-template let-row="row" ngx-datatable-cell-template>
              {{ row.time_slot.slotDateAndTime | date: 'short' }}
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="{{ 'SESSION_PRICE' | translate }}">
            <ng-template let-row="row" ngx-datatable-cell-template>
              {{ row.time_slot.sessionPrice }}
            </ng-template>
          </ngx-datatable-column>

        </ngx-datatable>
      </div>
    </section>
  </div>
</div>


            <!-- <div class="col-lg-12 col-sm-6 col-12" *ngIf="currentUser == 3">
                <h4>Recently Added Session</h4>
                <app-join-live-session ></app-join-live-session>
            </div> -->
        </div>
    </div>
</div>
<!-- Broker Tables -->
<div *ngIf="currentUser === 5" class="content-body mt-3">
  <h3 class="mb-2">Instructors</h3>
  <ngx-datatable
    [rows]="instructorsList"
    class="bootstrap core-bootstrap"
    [headerHeight]="50"
    [footerHeight]="50"
    [rowHeight]="60"
    [columnMode]="ColumnMode.force">

    <ngx-datatable-column name="#">
      <ng-template let-rowIndex="rowIndex" ngx-datatable-cell-template>
        {{ rowIndex + 1 }}
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Image">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <img [src]="row.image || 'assets/images/default-avatar.png'" 
             alt="user" width="40" height="40" style="border-radius: 50%;" />
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Username">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{ row.username }}
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Phone">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{ row.phone }}
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Status">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <span [ngClass]="{
          'badge badge-success': row.status === 'Approved',
          'badge badge-warning': row.status === 'Pending'
        }">{{ row.status }}</span>
      </ng-template>
    </ngx-datatable-column>
  </ngx-datatable>

  <hr class="my-4" />

  <h3 class="mb-2">Organizations</h3>
  <ngx-datatable
    [rows]="organizationsList"
    class="bootstrap core-bootstrap"
    [headerHeight]="50"
    [footerHeight]="50"
    [rowHeight]="60"
    [columnMode]="ColumnMode.force">

    <ngx-datatable-column name="#">
      <ng-template let-rowIndex="rowIndex" ngx-datatable-cell-template>
        {{ rowIndex + 1 }}
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Image">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <img [src]="row.image || 'assets/images/default-avatar.png'" 
             alt="org" width="40" height="40" style="border-radius: 50%;" />
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Username">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{ row.username }}
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Phone">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{ row.phone }}
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column name="Status">
      <ng-template let-row="row" ngx-datatable-cell-template>
        <span [ngClass]="{
          'badge badge-success': row.status === 'Approved',
          'badge badge-warning': row.status === 'Pending'
        }">{{ row.status }}</span>
      </ng-template>
    </ngx-datatable-column>
  </ngx-datatable>
</div>
