<div class="card">
  <h5 class="card-header">
    {{ brokerForm.get('id')?.value ? ('EDIT_BROKER' | translate) : ('ADD_BROKER' | translate) }}
  </h5>
</div>

<div *ngIf="isLoading" class="spinner-grow" role="status">
  <span class="sr-only">{{ 'LOADING' | translate }}</span>
</div>

<form *ngIf="!isLoading" [formGroup]="brokerForm" (ngSubmit)="onSubmit()">
  <div class="row">

    <!-- First Name -->
    <div class="form-group col-md-6 col-12">
      <label>{{ 'FIRST_NAME' | translate }}</label>
      <input type="text" class="form-control" formControlName="firstName" />
      <div *ngIf="brokerForm.get('firstName')?.invalid && brokerForm.get('firstName')?.touched" class="text-danger">
        {{ 'THIS_FIELD_IS_REQUIRED' | translate }}
      </div>
    </div>

    <!-- Last Name -->
    <div class="form-group col-md-6 col-12">
      <label>{{ 'LAST_NAME' | translate }}</label>
      <input type="text" class="form-control" formControlName="lastName" />
      <div *ngIf="brokerForm.get('lastName')?.invalid && brokerForm.get('lastName')?.touched" class="text-danger">
        {{ 'THIS_FIELD_IS_REQUIRED' | translate }}
      </div>
    </div>

    <!-- Email -->
    <div class="form-group col-md-6 col-12">
      <label>{{ 'EMAIL' | translate }}</label>
      <input type="email" class="form-control" formControlName="email" />
      <div *ngIf="brokerForm.get('email')?.errors?.['required'] && brokerForm.get('email')?.touched" class="text-danger">
        {{ 'THIS_FIELD_IS_REQUIRED' | translate }}
      </div>
      <div *ngIf="brokerForm.get('email')?.errors?.['email'] && brokerForm.get('email')?.touched" class="text-danger">
        {{ 'INVALID_EMAIL' | translate }}
      </div>
    </div>

    <!-- Password -->
    <div class="form-group col-md-6 col-12">
      <label>{{ 'PASSWORD' | translate }}</label>
      <input type="password" class="form-control" formControlName="password" />
      <div *ngIf="brokerForm.get('password')?.invalid && brokerForm.get('password')?.touched" class="text-danger">
        {{ 'THIS_FIELD_IS_REQUIRED' | translate }}
      </div>
    </div>

    <!-- Phone -->
    <div class="form-group col-md-6 col-12">
      <label>{{ 'PHONE' | translate }}</label>
      <input type="tel" class="form-control" formControlName="phone" />
      <div *ngIf="brokerForm.get('phone')?.invalid && brokerForm.get('phone')?.touched" class="text-danger">
        {{ 'THIS_FIELD_IS_REQUIRED' | translate }}
      </div>
    </div>

    <!-- Status -->
    <div class="form-group col-md-6 col-12">
      <label>{{ 'STATUS' | translate }}</label>
      <select class="form-control" formControlName="isActive">
        <option [ngValue]="true">{{ 'ACTIVE' | translate }}</option>
        <option [ngValue]="false">{{ 'INACTIVE' | translate }}</option>
      </select>
      <div *ngIf="brokerForm.get('isActive')?.invalid && brokerForm.get('isActive')?.touched" class="text-danger">
        {{ 'THIS_FIELD_IS_REQUIRED' | translate }}
      </div>
    </div>

    <!-- Info -->
    <div class="form-group col-md-12">
      <label>{{ 'INFO' | translate }}</label>
      <textarea class="form-control" formControlName="info" rows="3"></textarea>
      <div *ngIf="brokerForm.get('info')?.invalid && brokerForm.get('info')?.touched" class="text-danger">
        {{ 'THIS_FIELD_IS_REQUIRED' | translate }}
      </div>
    </div>

    <!-- Upload File -->
    <div class="form-group col-md-6 col-12">
      <label>{{ 'IMAGE' | translate }}</label>
      <input type="file" accept="image/*" class="form-control" (change)="onFileSelected($event)" />
      <div *ngIf="brokerForm.get('image')?.invalid && brokerForm.get('image')?.touched" class="text-danger">
        {{ 'THIS_FIELD_IS_REQUIRED' | translate }}
      </div>

      <div *ngIf="selectedFile">
        <img [src]="selectedFile" alt="{{ 'BROKER_IMAGE' | translate }}" style="width: 200px; height: 200px;" />
        <button type="button" class="btn btn-danger btn-sm mt-1" (click)="deleteImage()">
          {{ 'DELETE' | translate }}
        </button>
      </div>
    </div>

    <!-- Actions -->
    <div class="col-12 mt-2">
      <button type="submit" class="btn btn-primary mr-1">{{ 'SUBMIT' | translate }}</button>
      <button type="reset" class="btn btn-outline-secondary">{{ 'CANCEL' | translate }}</button>
    </div>

  </div>
</form>
